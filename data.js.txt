// –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ó–∞–ø–∏—Å—å –∑–∞ 5 –º–∏–Ω—É—Ç (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage)

const Zapis5MinData = {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    init: function() {
        // –ú–∞—Å—Ç–µ—Ä–∞
        if (!localStorage.getItem('masters')) {
            const masters = [
                {
                    id: 1,
                    name: "–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞",
                    age: 28,
                    city: "–ú–æ—Å–∫–≤–∞",
                    experience: 5,
                    rating: 4.8,
                    reviews_count: 154,
                    avatar_color: "#8A2BE2",
                    telegram: "@anna_beauty",
                    phone: "+79999876543",
                    specialties: ["MANICURE_PEDICURE", "WOMEN_HAIRCUT"],
                    description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Å—Ç–µ—Ä —Å 5-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º.",
                    services: [
                        { id: 1, name: "–ú–∞–Ω–∏–∫—é—Ä", price: 2500, duration: 60, category: "MANICURE_PEDICURE" },
                        { id: 2, name: "–ü–µ–¥–∏–∫—é—Ä", price: 3000, duration: 90, category: "MANICURE_PEDICURE" },
                        { id: 3, name: "–ö–æ–º–ø–ª–µ–∫—Å", price: 5000, duration: 120, category: "MANICURE_PEDICURE" }
                    ],
                    work_schedule: {
                        monday: ["10:00-13:00", "14:00-18:00"],
                        tuesday: ["10:00-13:00", "14:00-18:00"],
                        wednesday: ["10:00-13:00", "14:00-18:00"],
                        thursday: ["10:00-13:00", "14:00-18:00"],
                        friday: ["10:00-13:00", "14:00-18:00"],
                        saturday: [],
                        sunday: []
                    }
                }
            ];
            localStorage.setItem('masters', JSON.stringify(masters));
        }

        // –£—Å–ª—É–≥–∏
        if (!localStorage.getItem('services')) {
            const services = [
                { id: 1, name: "–ú–∞–Ω–∏–∫—é—Ä –∏ –ø–µ–¥–∏–∫—é—Ä", icon: "üíÖüèª", category: "MANICURE_PEDICURE" },
                { id: 2, name: "–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞", icon: "‚úÇÔ∏è", category: "MEN_HAIRCUT" },
                { id: 3, name: "–ñ–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞", icon: "üíá‚Äç‚ôÄÔ∏è", category: "WOMEN_HAIRCUT" },
                { id: 4, name: "–ë—Ä–æ–≤–∏", icon: "üëÅÔ∏è", category: "EYEBROWS" },
                { id: 5, name: "–†–µ—Å–Ω–∏—Ü—ã", icon: "üëÅÔ∏è‚Äçüó®Ô∏è", category: "EYELASHES" }
            ];
            localStorage.setItem('services', JSON.stringify(services));
        }

        // –ó–∞–ø–∏—Å–∏
        if (!localStorage.getItem('bookings')) {
            localStorage.setItem('bookings', JSON.stringify([]));
        }

        // –û—Ç–∑—ã–≤—ã
        if (!localStorage.getItem('reviews')) {
            localStorage.setItem('reviews', JSON.stringify([]));
        }
    },

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    getMasters: function() {
        return JSON.parse(localStorage.getItem('masters') || '[]');
    },

    getServices: function() {
        return JSON.parse(localStorage.getItem('services') || '[]');
    },

    getBookings: function() {
        return JSON.parse(localStorage.getItem('bookings') || '[]');
    },

    getReviews: function() {
        return JSON.parse(localStorage.getItem('reviews') || '[]');
    },

    getUsers: function() {
        return JSON.parse(localStorage.getItem('users') || '[]');
    },

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    updateMasters: function(masters) {
        localStorage.setItem('masters', JSON.stringify(masters));
    },

    updateBookings: function(bookings) {
        localStorage.setItem('bookings', JSON.stringify(bookings));
    },

    updateReviews: function(reviews) {
        localStorage.setItem('reviews', JSON.stringify(reviews));
    },

    updateUsers: function(users) {
        localStorage.setItem('users', JSON.stringify(users));
    },

    // –ü–æ–∏—Å–∫ –º–∞—Å—Ç–µ—Ä–∞ –ø–æ ID
    getMasterById: function(id) {
        const masters = this.getMasters();
        return masters.find(master => master.id === parseInt(id));
    },

    // –ü–æ–∏—Å–∫ —É—Å–ª—É–≥–∏ –ø–æ ID
    getServiceById: function(id) {
        const services = this.getServices();
        return services.find(service => service.id === parseInt(id));
    },

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
    addBooking: function(bookingData) {
        const bookings = this.getBookings();
        const newId = bookings.length > 0 ? Math.max(...bookings.map(b => b.id)) + 1 : 1;
        
        const booking = {
            id: newId,
            ...bookingData,
            created_at: new Date().toISOString(),
            status: 'pending_payment',
            booking_code: 'Z-' + new Date().getFullYear() + '-' + String(newId).padStart(6, '0')
        };
        
        bookings.push(booking);
        this.updateBookings(bookings);
        return booking;
    },

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
    addReview: function(reviewData) {
        const reviews = this.getReviews();
        const newId = reviews.length > 0 ? Math.max(...reviews.map(r => r.id)) + 1 : 1;
        
        const review = {
            id: newId,
            ...reviewData,
            created_at: new Date().toISOString(),
            verified: true
        };
        
        reviews.push(review);
        this.updateReviews(reviews);
        return review;
    }
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
Zapis5MinData.init();